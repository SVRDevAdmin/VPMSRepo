@model VPMS.Lib.Data.Models.Pets;

@{
	ViewData["Title"] = "Patients Page";
	ViewBag.SelectedMenu = "patientsMenu";
	ViewBag.Breed = Model.Breed;
	List<string> otherPets = ViewData["OtherPets"] as List<string>;
}

<style>
	.field-container {
		display: flex;
		flex-direction: column;
		margin-left: 1.5vw;
		margin-right: 1.5vw;
	}

	.formlabel {
		font-weight: bold;
		margin-bottom: 0.3vw;
	}

	.inputField {
		border: 0.1vw solid;
	}

	.halfSize {
		width: 36vw;
	}

	.quaterSize {
		width: 16.5vw;
	}

	/* circle-icon */
	#container {
		width: 1.6vw;
		height: 1.6vw;
		display: flex;
		background: transparent;
		border-radius: 2vw;
		color: blue;
		border: 0.15vw solid;
		font-size: 1.5vw;
		justify-content: center;
		align-items: center;
	}

	.hideContainer {
		display: none !important;
	}

	.currentPage {
		background-color: blue !important;
		color: white !important;
		border: none;
		border-style: none !important;
	}

	.currentPageText {
		color: black !important;
	}

	.medicalRecordPartition {
		width: 26vw;
		height: 27vw;
		overflow: auto;
	}

	.medicalRecordPartitionTitle {
		margin-left: 1.5vw;
		margin-right: 1.5vw;
		margin-bottom: 1.5vw;
	}
</style>

<div style="display: flex;">

	<div style="display: flex; align-items: center; margin-bottom: 3vw;">
		<img id="imgBackArrow" style=" margin-right: 1vw;" onclick="location.href='/Patients/ViewPatientProfile/@ViewBag.PatientID'" />
		<span class="textColor" style="font-size: 2vw;">Patients</span>
		<span class="textColor" style="font-size: 2vw; margin-left:1vw; margin-right:1vw; font-weight: bold;"> &#62; </span>
		<span class="textColor" style="font-size: 2vw;">Patient Profile</span>
		<span class="textColor" style="font-size: 2vw; margin-left:1vw; margin-right:1vw; font-weight: bold;"> &#62; </span>
		<span style="font-size: 2vw; color: dodgerblue;">@ViewData["PetName"] Profile</span>
	</div>
</div>

<div style="display: flex; justify-content: space-between;">
	<div id="LeftInfoContainer">
		
		<div class="containerBackground2" style="width: 40vw; color: white; padding: 0.7vw; padding-left: 1.5vw; border-top-left-radius: 0.5vw; border-top-right-radius: 0.5vw;  display: flex; justify-content: space-between; align-items: center;">
			<span>Pet Information</span>
			<button onclick="editPetInfo();" class="btn btn-lg btn-primary petInfoProfile" style="height: 2vw; width: 3vw; padding: 0; display: flex; justify-content: center; align-items: center;">
				<i class="fa fa-pencil-square-o" aria-hidden="true"></i>
			</button>
		</div>
		<div class="containerBorder" style="color: darkgray; width: 40vw; border-style: solid; border-bottom-left-radius: 0.5vw; border-bottom-right-radius: 0.5vw; padding: 1.5vw; padding-left: 0.5vw; padding-right: 0.5vw; padding-bottom: 0.5vw; margin-bottom: 2vw;">

			<div style="display: flex; margin-bottom: 1.5vw;">
				<div class="field-container quaterSize">
					<span class="formlabel">Pet Name</span>
					<input type="text" class="form-control form-field inputField petInfoProfile PetName hideContainer" value="@Model.Name" />
					<span class="formlabel petInfoProfile textColor PetName">@Model.Name</span>
				</div>

				<div class="field-container quaterSize">
					<span class="formlabel">Registration No.</span>
					<input type="text" class="form-control form-field inputField petInfoProfile RegistrationNo hideContainer" value="@Model.RegistrationNo" />
					<span class="formlabel petInfoProfile textColor RegistrationNo">@Model.RegistrationNo</span>
				</div>

				<div class="field-container quaterSize">
					<span class="formlabel">Sex</span>
					<select class="form-control form-field inputField petInfoProfile Sex hideContainer">
						<option value=""> -- Select Sex --</option>
						@if (Model.Gender == "M")
						{
							<option value="M" selected> Male</option>
							<option value="F"> Female</option>
							Model.Gender = "Male";
						}
						else
						{
							<option value="M"> Male</option>
							<option value="F" selected> Female</option>
							Model.Gender = "Female";
						}
					</select>
					<span class="formlabel petInfoProfile textColor Sex">@Model.Gender</span>
				</div>
			</div>

			<div style="display: flex; margin-bottom: 1.5vw;">
				<div class="field-container quaterSize">
					<span class="formlabel">Date Of Birth</span>
					<input type="date" class="form-control form-field inputField petInfoProfile DOB hideContainer" value="@Model.DOB.ToString("yyyy-MM-dd")" />
					<span class="formlabel petInfoProfile textColor DOB">@Model.DOB</span>
				</div>

				<div class="field-container quaterSize">
					<span class="formlabel">Age</span>
					<input type="text" class="form-control form-field inputField petInfoProfile Age hideContainer" value="@Model.Age" />
					<span class="formlabel petInfoProfile textColor Age">@Model.Age</span>
				</div>

				<div class="field-container quaterSize">
					<span class="formlabel">Species</span>
					<select onchange="changeSpecies(this);" class="form-control form-field inputField petInfoProfile Species hideContainer">
						<option value=""> -- Select Species --</option>
						@foreach (var species in ViewData["Species"] as List<string>)
						{
							if(species == Model.Species)
							{
								<option value="@species" selected> @species</option>
							}
							else
							{
								<option value="@species"> @species</option>
							}
						}
					</select>
					<span class="formlabel petInfoProfile textColor Species">@Model.Species</span>
				</div>
			</div>

			<div style="display: flex; margin-bottom: 1.5vw;">
				<div class="field-container quaterSize">
					<span class="formlabel">Breed</span>
					<select class="form-control form-field inputField petInfoProfile Breed hideContainer">
						<option value="" selected> -- Select Breed --</option>
					</select>
					<span class="formlabel petInfoProfile textColor Breed">@Model.Breed</span>
				</div>

				<div class="field-container quaterSize">
					<span class="formlabel">Allergies</span>
					<input type="text" class="form-control form-field inputField petInfoProfile Allergies hideContainer" value="@Model.Allergies" />
					<span class="formlabel petInfoProfile textColor Allergies">@Model.Allergies</span>
				</div>

				<div class="field-container quaterSize">
					<span class="formlabel">Color</span>
					<select class="form-control form-field inputField petInfoProfile Color hideContainer">
						<option value=""> -- Select Color --</option>
						@foreach (var color in ViewData["Color"] as List<string>)
						{
							if (color == Model.Color)
							{
								<option value="@color" selected> @color</option>
							}
							else
							{
								<option value="@color"> @color</option>
							}
						}
					</select>
					<span class="formlabel petInfoProfile textColor Color">@Model.Color</span>
				</div>
			</div>

			<div style="display: flex; margin-bottom: 1.5vw;">
				<div class="field-container quaterSize">
					<span class="formlabel">Height (cm)</span>
					<input type="text" class="form-control form-field inputField petInfoProfile Height hideContainer" value="@Model.Height" />
					<span class="formlabel petInfoProfile textColor Height">@Model.Height</span>
				</div>

				<div class="field-container quaterSize">
					<span class="formlabel">Weight (kg)</span>
					<input type="text" class="form-control form-field inputField petInfoProfile Weight hideContainer" value="@Model.Weight" />
					<span class="formlabel petInfoProfile textColor Weight">@Model.Weight</span>
				</div>

				<div class="field-container quaterSize">
					<span class="formlabel">Status</span>
					<select class="form-control form-field inputField petInfoProfile Status hideContainer">
						<option value=""> -- Select Status --</option>
						@if (Model.Status == 1)
						{
							<option value="1" selected> Active</option>
							<option value="2"> Inactive</option>
						}
						else
						{
							<option value="1"> Active</option>
							<option value="2" selected> Inactive</option>
						}
					</select>
					<span class="formlabel petInfoProfile textColor Status">@Model.Status</span>
				</div>
			</div>


			<div class="hideContainer petInfoProfile" style="text-align: end; margin-right: 1.6vw;">
				<button onclick="editPetInfo(this.parentElement)" class="btn btn-lg btn-secondary" style="width: 11vw; font-size: 1.5vw;"> Cancel </button>
				<button onclick="editPetInfo(this.parentElement);" class="btn btn-lg btn-primary" style="width: 11vw; font-size: 1.5vw;"> Save </button>
			</div>

		</div>
	</div>

	<div id="RightInfoContainer">
		<div>

			<div class="containerBackground2" style="width: 28vw; padding: 0.7vw; padding-left: 1.5vw; border-top-left-radius: 0.5vw; border-top-right-radius: 0.5vw;">
				All Pets
			</div>
			<div class="containerBorder textColor" style="color: darkgray; width: 28vw; border-style: solid; border-bottom-left-radius: 0.5vw; border-bottom-right-radius: 0.5vw; padding: 2vw; padding-left: 0.5vw; padding-right: 0.5vw; padding-bottom: 0.5vw; margin-bottom: 2vw;">

				<div id="allPets" style="display: flex; margin-bottom: 1.5vw;">
					@foreach(string otherPet in otherPets)
					{
						<div class="field-container" style="text-align: center;">
							<img src = "~/images/Cat profile image.png" style = "width: 4vw;" />
							<a href="/Patients/PetProfile/View/@ViewBag.PatientID/@otherPet"> @otherPet </a>
						</div>
					}
				</div>

			</div>

			<div class="containerBackground2" style="width: 28vw; padding: 0.7vw; padding-left: 1.5vw; border-top-left-radius: 0.5vw; border-top-right-radius: 0.5vw;">
				Upcoming Appointment
			</div>
			<div class="containerBorder" style="background-color: #c8dcfc; color: darkgray; width: 28vw; border-style: none; border-bottom-left-radius: 0.5vw; border-bottom-right-radius: 0.5vw; padding: 2vw; padding-left: 0.5vw; padding-right: 0.5vw; padding-bottom: 0.5vw; margin-bottom: 2vw;">

				<div style="display: flex; margin-bottom: 1.5vw;">
					<div class="field-container quaterSize">
						<span class="formlabel">Date</span>
						<span class="formlabel" style="color: black;">10/4/2024</span>
					</div>

					<div class="field-container quaterSize">
						<span class="formlabel">Time</span>
						<span class="formlabel" style="color: black;">13:00</span>
					</div>
				</div>


				<div style="display: flex; margin-bottom: 1.5vw;">
					<div class="field-container quaterSize">
						<span class="formlabel">Pet</span>
						<span class="formlabel" style="color: black;">Simba</span>
					</div>

					<div class="field-container quaterSize">
						<span class="formlabel">Service</span>
						<span class="formlabel" style="color: black;">General Check Up</span>
					</div>
				</div>


				<div style="display: flex; margin-bottom: 1.5vw;">
					<div class="field-container quaterSize">
						<span class="formlabel">Doctor</span>
						<span class="formlabel" style="color: black;">Dr. Kim Soo Jun</span>
					</div>
				</div>

			</div>
		</div>

	</div>
</div>

<script>
	var species = document.querySelector(".Species").value;
	var breedElement = document.querySelector(".Breed");
	breedList(species, breedElement, '@ViewBag.Breed');

	if ('@ViewBag.type' == 'edit') {
		editPetInfo();
	}

	function editPetInfo() {
		var element = document.querySelectorAll('.petInfoProfile');

		for (let i = 0; i < element.length; i++) {
			element[i].classList.toggle("hideContainer");
		}
	}

	function changeSpecies(e) {
		var breedElement = document.querySelector(".Breed");
		breedList(e.value, breedElement, "");
	}

	function breedList(species, breedElement, breedValue) {
		fetch('/Patients/BreedList?species=' + species)
			.then(response => {
				if (!response.ok) {
					throw new Error('Network response was not ok');
				}
				return response.json();
			})
			.then(data => {

				if (breedValue != "") {
					breedElement.innerHTML = '<option value=""> -- Select Breed -- </option>';
				}
				else {
					breedElement.innerHTML = '<option value="" selected> -- Select Breed -- </option>';
				}

				for (let i = 0; i < data.length; i++) {
					if (breedValue == data[i].breed) {
						breedElement.innerHTML = breedElement.innerHTML + '<option value="' + data[i].breed + '" selected>' + data[i].breed + '</option>';
					}
					else {
						breedElement.innerHTML = breedElement.innerHTML + '<option value="' + data[i].breed + '">' + data[i].breed + '</option>';
					}
				}
			})
			.catch(error => {
				console.error('There was a problem with the fetch operation:', error);
			});
	}
</script>